<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Nexus App</title>
    <!-- On lie notre feuille de style pour l'apparence de l'application -->
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="todo.css">
    <link rel="stylesheet" href="calendar.css">
    <link rel="stylesheet" href="calendar-app.css">
    <link rel="stylesheet" href="files.css">
</head>

<body>

    <!-- Loading Screen -->
    <div id="app-loader" class="app-loader">
        <div class="loader-content">
            <div class="loader-spinner"></div>
            <h2>Nexus App</h2>
            <p>Chargement en cours...</p>
        </div>
    </div>

    <div class="app-container">
        <!-- La barre lat√©rale pour la navigation -->
        <div class="sidebar">
            <button id="sidebar-toggle" class="sidebar-toggle" title="R√©duire/D√©velopper">
                <span class="toggle-icon">‚óÄ</span>
            </button>
            <ul id="service-list" class="service-list">
                <!-- Les services charg√©s dynamiquement viendront ici -->
            </ul>
            <div class="sidebar-actions">
                <button id="add-service-btn" class="add-service-btn" title="Ajouter un service">+</button>
                <button id="settings-btn" class="settings-btn" title="R√©glages">‚öôÔ∏è</button>
            </div>
        </div>

        <!-- La zone de contenu principale o√π les services s'afficheront -->
        <div class="content-area">
            <div id="welcome-container" class="welcome-container">
                <h1>Bienvenue dans Nexus App</h1>
                <p>Cliquez sur un service pour le charger, ou sur le '+' pour en ajouter un.</p>
            </div>
            <webview id="service-webview" class="service-webview" style="display: none;"></webview>
            <div id="todo-app-container" style="display: none;">
                <!-- Le contenu de l'application ToDo sera inject√© ici -->
            </div>
            <div id="dashboard-container" style="display: none;">
                <!-- Le contenu du Dashboard sera inject√© ici -->
            </div>
            <div id="files-app-container" style="display: none;">
                <!-- Le contenu de l'application Files sera inject√© ici -->
            </div>
            <div id="calendar-app-container" style="display: none;">
                <!-- Le contenu de l'application Calendrier sera inject√© ici -->
            </div>
        </div>
    </div>

    <!-- Fen√™tre modale pour l'ajout de service -->
    <div id="add-service-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h2>Ajouter un service</h2>
            <label for="service-name-input">Nom</label>
            <input type="text" id="service-name-input" placeholder="Ex: Mon Drive">
            <label for="service-url-input">URL</label>
            <input type="text" id="service-url-input" placeholder="Ex: https://nextcloud.example.com">

            <label for="service-internal-select">Ou choisir un service interne</label>
            <select id="service-internal-select" style="width: 100%; padding: 8px; margin-bottom: 15px;">
                <option value="">-- S√©lectionner --</option>
                <option value="internal://dashboard">Dashboard</option>
                <option value="internal://todo">ToDo List</option>
                <option value="internal://calendar">Calendrier</option>
                <option value="internal://files">Fichiers WebDAV</option>
                <option value="internal://gdrive">Fichiers GDrive</option>
                <option value="internal://ai">IA</option>
            </select>

            <div class="modal-actions">
                <button id="config-cancel-btn">Annuler</button>
                <button id="config-ok-btn">OK</button>
            </div>
        </div>
    </div>

    <!-- Fen√™tre modale pour l'ajout de liste ToDo -->
    <div id="add-list-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h2>Nouvelle liste</h2>
            <label for="list-name-input">Nom de la liste</label>
            <input type="text" id="list-name-input" placeholder="Ex: Courses">
            <div class="modal-actions">
                <button id="list-cancel-btn">Annuler</button>
                <button id="list-ok-btn">OK</button>
            </div>
        </div>
    </div>

    <!-- Fen√™tre modale pour les r√©glages -->
    <div id="settings-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content settings-modal-content">
            <div class="settings-container">
                <div class="settings-sidebar">
                    <ul>
                        <li class="active" data-section="files">Fichiers WebDAV</li>
                        <li data-section="gdrive">Fichiers GDrive</li>
                        <li data-section="gcal">Google Calendar</li>
                        <li data-section="ai">IA</li>
                        <!-- Future sections: <li data-section="general">G√©n√©ral</li> -->
                    </ul>
                </div>
                <div class="settings-content-wrapper">
                    <h2>R√©glages</h2>

                    <!-- Section Fichiers -->
                    <div id="settings-section-files" class="settings-section">
                        <h3>Affichage</h3>
                        <div class="setting-item">
                            <label class="toggle-switch">
                                <input type="checkbox" id="setting-show-hidden">
                                <span class="slider"></span>
                            </label>
                            <span class="setting-label">Afficher les fichiers cach√©s (commen√ßant par . ou ._)</span>
                        </div>

                        <h3>Connexion WebDAV</h3>
                        <p class="setting-desc">N√©cessaire pour le service 'Fichiers WebDAV'.</p>
                        <div class="form-group">
                            <label>URL</label>
                            <input type="text" id="settings-dav-url" placeholder="https://..." style="width: 100%;">
                        </div>
                        <div class="form-group">
                            <label>Utilisateur</label>
                            <input type="text" id="settings-dav-user" placeholder="username" style="width: 100%;">
                        </div>
                        <div class="form-group">
                            <label>Mot de passe</label>
                            <input type="password" id="settings-dav-pass" placeholder="password" style="width: 100%;">
                        </div>
                    </div>

                    <!-- Section GDrive -->
                    <div id="settings-section-gdrive" class="settings-section" style="display:none;">
                        <h3>Google Drive</h3>
                        <div class="setting-item">
                            <label class="toggle-switch">
                                <input type="checkbox" id="setting-gdrive-show-hidden">
                                <span class="slider"></span>
                            </label>
                            <span class="setting-label">Afficher les fichiers cach√©s</span>
                        </div>

                        <h3>Authentification Google Drive</h3>
                        <p class="setting-desc">Suivez ces deux √©tapes pour configurer l'acc√®s.</p>

                        <h4>√âtape 1 : Identifiants</h4>
                        <p class="setting-desc" style="font-size: 0.85em;">Copiez ici le Client ID et le Client Secret
                            depuis votre <a href="#"
                                onclick="require('electron').shell.openExternal('https://console.cloud.google.com/apis/credentials')">Google
                                Cloud Console</a>.</p>

                        <div
                            style="background: rgba(255, 193, 7, 0.1); border-left: 3px solid #ffc107; padding: 10px; margin-bottom: 15px; font-size: 0.85em; color: #ddd;">
                            <strong>Attention :</strong> Assurez-vous d'avoir configur√© ceci dans la console Google :
                            <ul style="margin: 5px 0 0 20px; padding: 0;">
                                <li><strong>Activer l'API :</strong> Allez dans "Biblioth√®que" et activez "Google Drive
                                    API".</li>
                                <li><strong>URI de redirection :</strong>
                                    <code>http://localhost:3000/oauth2callback</code>
                                </li>
                                <li><strong>Utilisateurs test :</strong> Ajoutez votre email dans l'√©cran de
                                    consentement.</li>
                            </ul>
                        </div>

                        <div class="form-group">
                            <label>Client ID</label>
                            <input type="text" id="settings-gdrive-client-id"
                                placeholder="...apps.googleusercontent.com" style="width: 100%;">
                        </div>
                        <div class="form-group">
                            <label>Client Secret</label>
                            <input type="password" id="settings-gdrive-client-secret" placeholder="Client Secret"
                                style="width: 100%;">
                        </div>

                        <h4>√âtape 2 : Connexion</h4>
                        <p class="setting-desc" style="font-size: 0.85em;">Cliquez ci-dessous pour autoriser
                            l'application (une page web s'ouvrira).</p>
                        <div class="form-group" style="margin-top: 15px;">
                            <button id="settings-gdrive-auth-btn"
                                style="background-color: #34A853; color: white; width: 100%;">Connexion
                                Google</button>
                            <button id="settings-gdrive-logout-btn"
                                style="background-color: #EA4335; color: white; width: 100%; display:none;">D√©connexion</button>
                        </div>
                        <div id="settings-gdrive-status" style="margin-top: 10px; font-size: 0.9em; color: gray;">
                        </div>
                    </div>

                    <!-- Section Google Calendar -->
                    <div id="settings-section-gcal" class="settings-section" style="display:none;">
                        <h3>Google Calendar</h3>
                        <p class="setting-desc">Synchronisez vos √©v√©nements avec Google Calendar.</p>

                        <h4>√âtape 1 : Identifiants</h4>
                        <p class="setting-desc" style="font-size: 0.85em;">Copiez ici le Client ID et le Client Secret
                            depuis votre <a href="#"
                                onclick="require('electron').shell.openExternal('https://console.cloud.google.com/apis/credentials')">Google
                                Cloud Console</a>.</p>

                        <div
                            style="background: rgba(255, 193, 7, 0.1); border-left: 3px solid #ffc107; padding: 10px; margin-bottom: 15px; font-size: 0.85em; color: #ddd;">
                            <strong>Attention :</strong> Assurez-vous d'avoir configur√© ceci dans la console Google :
                            <ul style="margin: 5px 0 0 20px; padding: 0;">
                                <li><strong>Activer l'API :</strong> Allez dans "Biblioth√®que" et activez "Google
                                    Calendar
                                    API".</li>
                                <li><strong>URI de redirection :</strong>
                                    <code>http://localhost:3001/oauth2callback</code>
                                </li>
                                <li><strong>Utilisateurs test :</strong> Ajoutez votre email dans l'√©cran de
                                    consentement.</li>
                            </ul>
                        </div>

                        <div class="form-group">
                            <label>Client ID</label>
                            <input type="text" id="settings-gcal-client-id" placeholder="...apps.googleusercontent.com"
                                style="width: 100%;">
                        </div>
                        <div class="form-group">
                            <label>Client Secret</label>
                            <input type="password" id="settings-gcal-client-secret" placeholder="Client Secret"
                                style="width: 100%;">
                        </div>

                        <h4>√âtape 2 : Connexion</h4>
                        <p class="setting-desc" style="font-size: 0.85em;">Cliquez ci-dessous pour autoriser
                            l'application (une page web s'ouvrira).</p>
                        <div class="form-group" style="margin-top: 15px;">
                            <button id="settings-gcal-auth-btn"
                                style="background-color: #34A853; color: white; width: 100%;">Connexion
                                Google</button>
                            <button id="settings-gcal-logout-btn"
                                style="background-color: #EA4335; color: white; width: 100%; display:none;">D√©connexion</button>
                        </div>
                        <div id="settings-gcal-status" style="margin-top: 10px; font-size: 0.9em; color: gray;">
                        </div>

                        <h4 id="settings-gcal-calendars-title" style="display:none; margin-top: 25px;">√âtape 3 :
                            S√©lection des calendriers</h4>
                        <p class="setting-desc" id="settings-gcal-calendars-desc"
                            style="font-size: 0.85em; display:none;">Choisissez quels calendriers afficher (y compris
                            les calendriers partag√©s).</p>
                        <div id="settings-gcal-calendars-list"
                            style="display:none; max-height: 300px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 10px; padding: 10px; margin-top: 10px;">
                            <!-- Calendar checkboxes will be inserted here -->
                        </div>
                    </div>

                    <!-- Section AI -->
                    <div id="settings-section-ai" class="settings-section" style="display:none;">
                        <h3>Assistant IA</h3>
                        <p class="setting-desc">Choisissez votre assistant IA pr√©f√©r√©.</p>

                        <div class="form-group">
                            <label class="ai-provider-option">
                                <input type="radio" name="ai-provider" value="gemini">
                                <span class="ai-provider-label">ü§ñ Gemini (Google AI)</span>
                            </label>
                            <label class="ai-provider-option">
                                <input type="radio" name="ai-provider" value="chatgpt">
                                <span class="ai-provider-label">üí¨ ChatGPT (OpenAI)</span>
                            </label>
                            <label class="ai-provider-option">
                                <input type="radio" name="ai-provider" value="claude">
                                <span class="ai-provider-label">üß† Claude (Anthropic)</span>
                            </label>
                            <label class="ai-provider-option">
                                <input type="radio" name="ai-provider" value="deepseek">
                                <span class="ai-provider-label">üîç DeepSeek</span>
                            </label>
                            <label class="ai-provider-option">
                                <input type="radio" name="ai-provider" value="grok">
                                <span class="ai-provider-label">üöÄ Grok (xAI)</span>
                            </label>
                            <label class="ai-provider-option">
                                <input type="radio" name="ai-provider" value="perplexity">
                                <span class="ai-provider-label">üîÆ Perplexity</span>
                            </label>
                            <label class="ai-provider-option">
                                <input type="radio" name="ai-provider" value="mistral">
                                <span class="ai-provider-label">üå™Ô∏è Mistral</span>
                            </label>
                            <label class="ai-provider-option">
                                <input type="radio" name="ai-provider" value="llama">
                                <span class="ai-provider-label">ü¶ô Llama</span>
                            </label>
                        </div>

                        <div id="settings-ai-status" style="margin-top: 10px; font-size: 0.9em; color: gray;">
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button id="settings-close-btn">Fermer</button>
                <button id="settings-save-btn"
                    style="background-color: var(--primary-color, #007aff); color: white;">Enregistrer</button>
            </div>
        </div>
    </div>

    <!-- On lie notre script de rendu qui g√®re l'interactivit√© de la page -->
    <script src="./renderer.js"></script>
</body>

</html>